---
import ArrowDown from "../components/ArrowDown.astro";
import XIcon from "./XIcon.astro";
---

<header class="flex w-full flex-col justify-center items-center">
  <div class="w-full lista">
    <nav>
      <a href="/" class="w-max">
        <img
          src="/logo-arte-dental-full-alt.png"
          alt="Logo Harmony"
          class="w-full max-w-32"
        />
      </a>
      <button id="Open" class="md:hidden" aria-label="Menu">
        <span class="bg-primary"></span>
        <span class="bg-primary"></span>
        <span class="bg-primary"></span>
      </button>
      <ul class="list bg-primary/90 text-white text-xl md:text-black" id="menu">
        <li class="md:hidden">
          <button id="Close">
            <XIcon class="w-8 h-8 text-white" />
          </button>
        </li>
        <li><a href="/" class="transition md:hover:text-third">Inicio</a></li>
        <li id="services">
          <a href="/#servicios" class="transition md:hover:text-third"
            >Sercicios</a
          >
        </li>
        <li class="grid place-items-center">
          <button
            class="text-white text-xl px-2 py-2 transition hover:text-third cursor-pointer relative flex md:text-black justify-center items-center"
            aria-label="Menu carillas"
            id="carillas"
          >
            Promociones
            <ArrowDown
              class="w-5 h-5 ml-[4px] transition md:w-5 md:pl-1"
              id="arrow"
            />
          </button>
          <div
            class="max-h-0 transition-all duration-300 flex flex-col overflow-hidden md:absolute md:top-10 md:duration-150 md:bg-slate-200/90 md:rounded-xl"
            id="dropdown-menu"
          >
            <a
              href="/carillas"
              class="md:text-base transition md:hover:text-third">Carillas</a
            >
            <a
              href="/microcarillas"
              class="md:text-base transition md:hover:text-third"
              >Microcarillas</a
            >
          </div>
        </li>
        <li id="location">
          <a href="#ubicacion" class="transition md:hover:text-third"
            >Ubicación</a
          >
        </li>
        <li>
          <a
            href="https://wa.me/525516513563?text=Buenas%20tardes,%20solicito%20informaci%C3%B3n%20sobre"
            target="_blank"
            class="transition md:hover:text-third"
            rel="noopener noreferrer"
            title="Número de WhatsApp de la clínica"
          >
            Contacto
          </a>
        </li>
      </ul>
    </nav>
  </div>
</header>

<style>
  nav {
    width: 100%;
    height: 80px;
    padding: 0 1rem;
    max-width: 1400px;
    display: flex;
    justify-content: space-around;
    align-items: center;
  }
  .lista {
    background-color: var(--blue-100);
  }
  nav > a {
    width: 70%;
    max-width: 200px;
  }
  .list {
    display: none;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    position: fixed;
    top: 0;
    right: 0;
    width: 100vw;
    height: 100svh;
    list-style: none;
    z-index: 10;
    transform: translateX(-100%);
  }
  .list li {
    margin-top: 20px;
  }
  .list li a {
    position: relative;
    display: inline-block;
    padding: 8px;
    text-align: center;
    letter-spacing: 1px;
    text-decoration: none;
    background: transparent;
    cursor: pointer;
    transition: ease-out 0.35s;
    border-radius: 10px;
    box-shadow: inset 0 0 0 0 var(--gold-200);
  }
  .list li a:hover {
    box-shadow: inset 0 -100px 0 0 var(--gold-100);
  }
  .list li a:active {
    transform: scale(0.9);
  }
  button {
    cursor: pointer;
  }
  button span {
    width: 30px;
    height: 4px;
    margin-top: 7px;
    display: block;
    border-radius: 5px;
  }
  #dropdown svg {
    transition: all 0.175s ease-out;
  }
  #dropdown:hover svg {
    transition: all 0.175s ease-out;
    transform: rotate(180deg);
    padding-left: 0;
    padding-right: 3px;
  }
  nav {
    animation: nav-shadown 1s linear both;
    animation-timeline: scroll();
    animation-range: 0 100px;
  }
  .dropdown {
    opacity: 0;
    transition: all 0.21s ease-out;
    background-color: rgb(209 213 219 / 0.8);
    --tw-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1),
      0 4px 6px -4px rgb(0 0 0 / 0.1);
    --tw-shadow-colored: 0 10px 15px -3px var(--tw-shadow-color),
      0 4px 6px -4px var(--tw-shadow-color);
    box-shadow: var(--tw-ring-offset-shadow, 0 0 #0000),
      var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);
    --tw-ring-offset-shadow: var(--tw-ring-inset) 0 0 0
      var(--tw-ring-offset-width) var(--tw-ring-offset-color);
    --tw-ring-shadow: var(--tw-ring-inset) 0 0 0
      calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color);
    box-shadow: var(--tw-ring-offset-shadow), var(--tw-ring-shadow),
      var(--tw-shadow, 0 0 #0000);
    --tw-ring-color: rgb(255 255 255 / 0.1);
    --tw-backdrop-blur: blur(8px);
    -webkit-backdrop-filter: var(--tw-backdrop-blur)
      var(--tw-backdrop-brightness) var(--tw-backdrop-contrast)
      var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate)
      var(--tw-backdrop-invert) var(--tw-backdrop-opacity)
      var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);
    backdrop-filter: var(--tw-backdrop-blur) var(--tw-backdrop-brightness)
      var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale)
      var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert)
      var(--tw-backdrop-opacity) var(--tw-backdrop-saturate)
      var(--tw-backdrop-sepia);
  }
  @media (max-width: 375px) {
    nav a {
      padding-left: 0.25rem;
      padding-right: 0.25rem;
    }
    nav {
      font-size: 1.05rem;
      line-height: 1rem;
    }
  }
  #Close {
    position: relative;
    top: 0;
    right: -100px;
  }
  #Close i {
    transition: all 0.275s linear;
  }
  #Close i:hover {
    transition: all 0.275s linear;
    color: rgb(219, 182, 115);
  }
  header div:nth-last-child(2) {
    background: linear-gradient(45deg, var(--gold-100), var(--gold-200));
    color: white;
  }
  @keyframes showMenu {
    0% {
      transform: translateX(-100%);
    }
    100% {
      transform: translateX(0%);
    }
  }
  @keyframes hideMenu {
    0% {
      transform: translate(0%);
    }
    100% {
      transform: translate(-100%);
    }
  }
  @media (min-width: 768px) {
    .list {
      display: flex;
      flex-direction: row;
      justify-content: flex-end;
      align-items: center;
      position: relative;
      width: 70%;
      height: auto;
      background-color: transparent;
      list-style: none;
      z-index: 10;
      transform: translateX(0%);
    }
    .list li {
      margin-top: 0;
      font-size: 20px;
    }
    nav {
      justify-content: space-between;
    }
    .lista {
      display: flex;
      justify-content: center;
      align-items: center;
    }
  }
</style>

<script>
  const abrir = document.getElementById("Open");
  const menu: any = document.getElementById("menu");
  const cerrar = document.getElementById("Close");
  // Create a MediaQueryList object
  const x = window.matchMedia("(max-width: 768px)");

  function matchM(x: any) {
    if (x.matches) {
      abrir?.addEventListener("click", () => {
        menu.style.display = "flex";
        menu.style.animation = "showMenu 0.5s forwards";
      });
      cerrar?.addEventListener("click", () => {
        menu.style.animation = "hideMenu 0.5s forwards";
        setTimeout(() => {
          menu.style.display = "none";
        }, 500);
      });
    }
  }
  // Call listener function at run time
  matchM(x);

  // Attach listener function on state changes
  x.addEventListener("change", function () {
    matchM(x);
  });

  const $btnDropdown = document.getElementById("carillas");
  const $dropdownMenu = document.getElementById("dropdown-menu");
  const $arrow = document.getElementById("arrow");
  const $serviciosBtn = document.getElementById("services");
  const $ubicacionBtn = document.getElementById("location");

  $btnDropdown?.addEventListener("click", () => {
    $dropdownMenu?.classList.toggle("max-h-96");
    $arrow?.classList.toggle("rotate-180");
  });

  $serviciosBtn?.addEventListener("click", () => {
    menu.style.animation = "hideMenu 0.5s forwards";
    setTimeout(() => {
      menu.style.display = "none";
    }, 500);
  });
  $ubicacionBtn?.addEventListener("click", () => {
    menu.style.animation = "hideMenu 0.5s forwards";
    setTimeout(() => {
      menu.style.display = "none";
    }, 500);
  });
</script>
